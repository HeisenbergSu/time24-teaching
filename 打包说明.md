# 24时计时法教学系统 - 打包部署说明

## 📦 打包步骤

### 前置要求

1. **Node.js** (版本 >= 12.0)
   - 下载地址: https://nodejs.org/
   - 安装后验证: 打开命令行，输入 `node --version`

2. **Python** (版本 >= 3.6)
   - 下载地址: https://www.python.org/
   - 安装时勾选 "Add Python to PATH"
   - 安装后验证: 打开命令行，输入 `python --version`

3. **npm** (通常随 Node.js 一起安装)
   - 验证: 打开命令行，输入 `npm --version`

### 执行打包

1. **打开命令行**，进入项目根目录：
   ```bash
   cd D:\code\time24-teaching
   ```

2. **运行打包脚本**：
   ```bash
   python build_project.py
   ```

3. **等待打包完成**（可能需要 5-10 分钟）

4. **打包完成后**，在项目根目录会生成 `release` 文件夹，包含：
   - `TimeTeachingSystem.exe` - 主程序
   - `启动系统.bat` - 一键启动脚本
   - `使用说明.txt` - 用户使用说明

### 打包过程说明

打包脚本会自动执行以下步骤：

1. ✅ **检查环境** - 验证 Node.js、npm、Python 是否安装
2. ✅ **构建前端** - 编译 Vue 项目为静态文件
3. ✅ **准备资源** - 将前端文件复制到后端目录
4. ✅ **安装依赖** - 安装 Python 后端依赖
5. ✅ **打包程序** - 使用 PyInstaller 打包为单文件可执行程序
6. ✅ **创建发布包** - 生成包含启动脚本的发布文件夹

## 🚀 客户使用说明

### 方法一：使用启动脚本（推荐）

1. 将整个 `release` 文件夹发送给客户
2. 客户双击 `启动系统.bat` 文件
3. 等待系统启动（会显示命令行窗口）
4. 在浏览器中访问: `http://localhost:5000`

### 方法二：直接运行

1. 双击 `TimeTeachingSystem.exe` 文件
2. 在浏览器中访问: `http://localhost:5000`

### 停止系统

在命令行窗口中按 `Ctrl+C`，然后关闭窗口。

## 📋 系统要求

- **操作系统**: Windows 7 或更高版本
- **浏览器**: Chrome、Edge、Firefox 等现代浏览器
- **网络**: 无需联网（本地运行）
- **其他**: 无需安装 Python、Node.js 等开发环境

## ⚙️ 配置说明

### 默认端口

系统默认运行在 `http://localhost:5000`

如果端口被占用，可以：
1. 关闭占用 5000 端口的其他程序
2. 或者修改 `backend/app.py` 中的端口配置后重新打包

### 默认账号

- **教师账号**:
  - 用户名: `teacher`
  - 密码: `teacher123`

⚠️ **注意**: 生产环境建议修改默认密码！

### 数据库

- 首次运行会自动创建数据库文件 `time24_teaching.db`
- 数据库文件会保存在可执行文件同目录下
- 删除数据库文件会清空所有数据（包括学生记录、答题记录等）

## 🔧 常见问题

### 1. 打包失败

**问题**: 提示缺少某个模块或工具

**解决**:
- 确保已安装 Node.js 和 Python
- 确保已安装所有依赖: `pip install -r backend/requirements.txt`
- 确保前端依赖已安装: `cd frontend && npm install`

### 2. 可执行文件无法运行

**问题**: 双击 exe 文件没有反应或报错

**解决**:
- 检查是否被杀毒软件拦截（添加信任）
- 尝试右键"以管理员身份运行"
- 查看是否有错误提示信息

### 3. 端口被占用

**问题**: 启动时提示端口 5000 已被占用

**解决**:
- 关闭占用 5000 端口的程序
- 或修改代码中的端口号后重新打包

### 4. 前端页面无法访问

**问题**: 访问 http://localhost:5000 显示空白或错误

**解决**:
- 检查后端是否正常启动（查看命令行窗口）
- 确认浏览器地址栏输入正确
- 尝试清除浏览器缓存

### 5. 打包文件过大

**问题**: 生成的 exe 文件很大（可能 100MB+）

**解决**:
- 这是正常的，因为包含了 Python 解释器和所有依赖
- 可以使用 UPX 压缩（已在 spec 文件中启用）
- 或者使用 `--onedir` 模式（多文件模式，但文件更分散）

## 📝 打包优化建议

### 减小文件大小

1. **使用虚拟环境**打包，只包含必要的依赖
2. **排除不必要的模块**（在 spec 文件的 `excludes` 中添加）
3. **使用 UPX 压缩**（已在配置中启用）

### 隐藏控制台窗口

如果需要隐藏控制台窗口（后台运行），修改 `backend/TimeTeachingSystem.spec` 文件：

```python
console=False,  # 改为 False
```

然后重新打包。

### 添加图标

1. 准备一个 `.ico` 格式的图标文件
2. 在 spec 文件中添加：
   ```python
   icon='path/to/icon.ico',
   ```

## 🔐 安全建议

1. **修改默认密码**: 生产环境务必修改默认教师密码
2. **数据库加密**: 如需更高安全性，可考虑使用加密的 SQLite 或 PostgreSQL
3. **HTTPS**: 如需远程访问，建议配置 HTTPS

## 📞 技术支持

如有问题，请检查：
1. 打包日志中的错误信息
2. 运行时的命令行输出
3. 浏览器控制台的错误信息

---

**最后更新**: 2024年
**版本**: 1.0.0

